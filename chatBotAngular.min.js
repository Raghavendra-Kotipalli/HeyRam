!function(){var e=angular.module("myApp",["ui.bootstrap"]);e.controller("myController",["$scope","$interval","$http","$location","$anchorScroll","$window","$uibModal",function(a,e,s,t,o,n,i){$("#loadingDiv").hide(),a.displayChatBox=!1,a.chatImage=!0,a.config={headers:{Authorization:"Bearer 977c6dcba72a4586abfac774a1932a7e",Accept:"text/plain"}},a.message,a.messages=[{content:"Hi there! Welcome to DBS Buzz, select the topic or write your question.",timestamp:new Date,bot:1}],a.messageText,a.sendMessage=function(){$("#loadingDiv").show();var e=$.parseHTML('<div class="box"> <div class="container">'+a.message.content+"</div>");$("#messageBody").append(e),a.message.timestamp=new Date,a.messageBody=angular.copy(a.message),""!=a.messageBody.content&&null!=a.messageBody.content&&(a.messageBody.bot=0,a.messages.push(a.messageBody),a.scrollBottom()),a.data={query:a.message.content,lang:"en",sessionId:"12345"},s.post("https://api.dialogflow.com/v1/query?v=20150910",a.data,a.config).then(function(e){var s=$.parseHTML('<div class="box"> <i class="fab fa-reddit-alien bot-icon ng-scope"></i><div class="container"> <p class="ng-binding">'+e.data.result.fulfillment.speech+"</div>");$("#messageBody").append(s),a.messages.push({content:e.data.result.fulfillment.speech,timestamp:e.data.timestamp,bot:1}),a.message=null,$("#loadingDiv").hide(),a.scrollBottom()})},a.getService=function(){$("#loadingDiv").show();var e=$.parseHTML('<div class="box"><div class="container"> <p class="ng-binding"><p>Services</p> </div>');$("#messageBody").append(e),a.messageBody=angular.copy({content:"Sevices",timestamp:new Date}),""!=a.messageBody.content&&null!=a.messageBody.content&&(a.messageBody.bot=0,a.messages.push(a.messageBody),a.scrollBottom()),a.data={query:"Services",lang:"en",sessionId:"12345"},s.post("https://api.dialogflow.com/v1/query?v=20150910",a.data,a.config).then(function(e){var s=$.parseHTML('<div class="box"> <i class="fab fa-reddit-alien bot-icon ng-scope"></i><div class="container"> <p class="ng-binding">'+e.data.result.fulfillment.speech+"</p></div>");$("#messageBody").append(s),a.messages.push({content:e.data.result.fulfillment.speech,timestamp:e.data.timestamp,bot:1}),a.message=null,$("#loadingDiv").hide(),a.scrollBottom()})},a.getVideo=function(){$("#loadingDiv").show();$("#messageBody").append('<div class="box"><div class="container"> <p class="ng-binding">DBS Video</div>'),a.messageBody=angular.copy({content:"Video",timestamp:new Date}),""!=a.messageBody.content&&null!=a.messageBody.content&&(a.messageBody.bot=0,a.messages.push(a.messageBody),a.scrollBottom()),a.data={query:"video",lang:"en",sessionId:"12345"},s.post("https://api.dialogflow.com/v1/query?v=20150910",a.data,a.config).then(function(e){var s='<div class="box"> <i class="fab fa-reddit-alien bot-icon ng-scope"></i><div class="container"> <p class=\'ng-binding">'+e.data.result.fulfillment.speech+"</div>";$("#messageBody").append(s),a.messages.push({content:e.data.result.fulfillment.speech,timestamp:e.data.timestamp,bot:1}),a.message=null,$("#loadingDiv").hide(),a.scrollBottom()})},a.getContact=function(){$("#loadingDiv").show();$("#messageBody").append('<div class="box"><div class="container"> <p class="ng-binding">Contact Us</div>'),a.messageBody=angular.copy({content:"Contact Us",timestamp:new Date}),""!=a.messageBody.content&&null!=a.messageBody.content&&(a.messageBody.bot=0,a.messages.push(a.messageBody),a.scrollBottom()),a.data={query:"Contact Us",lang:"en",sessionId:"12345"},s.post("https://api.dialogflow.com/v1/query?v=20150910",a.data,a.config).then(function(e){var s='<div class="box"> <i class="fab fa-reddit-alien bot-icon ng-scope"></i><div class="container"> <p class="ng-binding">'+e.data.result.fulfillment.speech+"</div>";$("#messageBody").append(s),a.messages.push({content:e.data.result.fulfillment.speech,timestamp:e.data.timestamp,bot:1}),a.message=null,$("#loadingDiv").hide(),a.scrollBottom()})},a.openForm=function(){a.displayChatBox=!0,a.chatImage=!1},a.closeChatBox=function(){a.displayChatBox=!1,a.chatImage=!0},a.clearChat=function(){$("#messageBody").html(""),$("#messageBody").append($.parseHTML('<div class="box"> <i class="fab fa-reddit-alien bot-icon ng-scope"></i> <div class="container"> <div id="divMessages">Hi there! Welcome to DBS BUZZ , select the topic or write your question.</div> </div> </div>')),a.messages=[{content:"Hi there!Welcome to DBS BUZZ ,  select the topic or write your question.",timestamp:new Date,bot:1}]},a.scrollBottom=function(){var e=document.getElementById("messageBody");e.scrollTop=e.scrollHeight},a.redirectToBookingUrl=function(){i.open({templateUrl:"schedule.html",controller:"scheduleController",size:"100"})},$(document).on("click","body .services",function(){var e=$(this).text();a.message={},a.message.content=e,a.message.timestamp=new Date,a.sendMessage()})}]),e.controller("scheduleController",["$scope","$interval","$http","$location","$anchorScroll","$window","$uibModalStack",function(r,e,s,a,t,o,n){r.dateSelected=!1,r.selectedTime,$(".calendar").pignoseCalendar({format:"MM/DD YYYY",select:function(e,s){r.selectedDate=e,console.log(e[0],e[1]),r.clickedFuncntion()},theme:"dark",minDate:moment().subtract(0,"days")}),r.closeModal=function(){n.dismissAll()},r.scheduleEvent=function(){console.log("userName:"+r.name),console.log("emailId:"+r.emailId),console.log("Emailbody:"+r.message),r.config1={headers:{"Content-Type":"application/json"}};var e=moment(r.selectedTime,"hh:mm").add(30,"minutes").format("hh:mm");r.data1={toAddress:r.emailId,subject:"Schedule a Call with DoBizSystems",startTime:moment(r.displayDate+" "+r.selectedTime).format("YYYY-MM-DDTHH:mm:00+02:00"),endTime:moment(r.displayDate+" "+e).format("YYYY-MM-DDTHH:mm:00+02:00"),emailBody:"Hi "+r.name+"<br/><br> This is a confirmation that you have scheduled a call.<br> on the date of "+r.displayDate+" at "+r.selectedTime+"<br><br> This topic has been given when schedule a call <br>'+$scope.message+'<br> Thank you for choosing our company."};var s,a,t,o,n,i,l,c=moment(r.displayDate+" "+r.selectedTime).format("YYYY-MM-DDTHH:mm:00+02:00"),d=moment(r.displayDate+" "+e).format("YYYY-MM-DDTHH:mm:00+02:00"),m="Hi "+r.name+"<br/><br> This is a confirmation that you have scheduled a call.<br> on the date of "+r.displayDate+" at "+r.selectedTime+"<br><br> This topic has been given when schedule a call <br>"+r.message+"<br> Thank you for choosing our company.";s=r.name,a=r.emailId,t=r.phone,o=c,n=d,i="Schedule a Call with DoBizSystems",l=m,$.ajax({type:"post",url:"schedule.php",data:{name:s,email:a,phone:t,starttime:o,endtime:n,sub:i,msg:l},success:function(e){console.log(e)}}),$("#afterTimeTable").css("display","none"),$("#scheduleEvent").css("display","none"),$("#thankYouMessage").css("display","block")},r.clickedFuncntion=function(){var e;r.selectedDate[0]&&(e=moment(r.selectedDate[0]._d,"DD/MM/YYYY HH:mm"),r.weekDay=e.format("dddd"),r.displayDate=e.format("LL"),console.log("date:"+e),$("#afterCalender").css("display","block"),$("#day").text(r.weekDay),$("#displayDate").text(r.displayDate),$(".calendar").css("display","none"),$("#backButton").css("display","block"),$("#timingsTable").css("display","block"))},r.showCalender=function(){$(".calendar").css("display","block"),$("#backButton").css("display","none"),$("#timingsTable").css("display","none"),$("#afterCalender").css("display","none")},r.timeButton=function(){var e=document.getElementsByTagName("table")[0].getElementsByTagName("tbody")[0],o=[];e.onclick=function(e){for(var s=(e=e||window.event).srcElement||e.target;s&&"TR"!==s.nodeName;)s=s.parentNode;if(s)for(var a=s.getElementsByTagName("td"),t=0;t<a.length;t++)o.push(a[t].innerHTML);r.selectedTime=o,$("#scheduleEvent").css("display","block"),$("#selectedTime").text(r.selectedTime),$("#timingsTable").css("display","none"),$("#afterCalender").css("display","none"),$("#afterTimeTable").css("display","block"),$("#day1").text(r.weekDay),$("#displayDate1").text(r.displayDate),$("#backButton1").css("display","block")}},r.showTimeTable=function(){$("#afterCalender").css("display","block"),$("#afterTimeTable").css("display","none"),$("#timingsTable").css("display","block"),$("#scheduleEvent").css("display","none")}}]),e.directive("myEnter",function(){return function(s,e,a){e.bind("keydown keypress",function(e){13===e.which&&(s.$apply(function(){s.$eval(a.myEnter)}),e.preventDefault())})}})}();